<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="6/4/2021 8:53:20 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="WIN-78376SSIAGK"
  DTS:CreatorName="WIN-78376SSIAGK\Administrator"
  DTS:DTSID="{D1BF90F6-6A67-4A15-8500-3BFE8B8AC36D}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.157"
  DTS:LocaleID="1033"
  DTS:ObjectName="Infrastructure"
  DTS:PackageType="5"
  DTS:VersionBuild="45"
  DTS:VersionGUID="{B806F35B-D01A-4527-8469-664EB8BC028C}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[TheVoice]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{A058B0ED-09AD-4697-88B4-F4FFEBDF6CF1}"
      DTS:ObjectName="TheVoice">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Project::TheVoice]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Project::DWH]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=WIN-78376SSIAGK;Initial Catalog=TheVoice;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Create_DWH_DB"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4BDEC4A5-6A8D-4674-BEFC-FEE3EB791447}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create_DWH_DB"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; Â© 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{A058B0ED-09AD-4697-88B4-F4FFEBDF6CF1}"
          SQLTask:SqlStatementSource="use master&#xA;&#xA;IF EXISTS ( select * from sys.databases where name='TheVoice_ETL' ) &#xA;begin&#xA;&#xA;&#x9;alter database [TheVoice_ETL] set single_user with rollback immediate&#xA;&#x9;Drop DataBase TheVoice_ETL&#xA;&#x9;&#xA;end&#xA;Create DataBase TheVoice_ETL&#xA;Go&#xA;&#x9;Use TheVoice_ETL&#xA;GO&#xA;--------------------Create Schema&#xA;Create Schema MRR;&#xA;GO&#xA;Create Schema STG;&#xA;GO&#xA;Create Schema DIM;&#xA;GO&#xA; Create Schema FACT;&#xA;GO&#xA; Create Schema Integration;&#xA;GO&#xA;--------------------End Create Schema&#xA;CREATE TABLE [MRR].[call_type](&#xA;&#x9;[call_type_code] [nvarchar](100) NULL,&#xA;&#x9;[call_type_desc] [nvarchar](100) NULL,&#xA;&#x9;[priceperminuter] [decimal](10, 2) NULL,&#xA;&#x9;[call_type] [nvarchar](50) NULL,&#xA;&#x9;[SysStartTime] [datetime2](7) NULL,&#xA;&#x9;[SysEndTime] [datetime2](7) NULL&#xA;) ON [PRIMARY]&#xA;&#xA;CREATE TABLE [MRR].[countries](&#xA;&#x9;[COUNTRY_CODE] [varchar](100) NULL,&#xA;&#x9;[DESC] [varchar](100) NULL,&#xA;&#x9;[REGION] [varchar](100) NULL,&#xA;&#x9;[AREA] [varchar](100) NULL,&#xA;&#x9;[insert_date] [datetime] NULL,&#xA;&#x9;[update_date] [datetime] NULL,&#xA;&#x9;[SysStartTime] [datetime2](7) NULL,&#xA;&#x9;[SysEndTime] [datetime2](7) NULL&#xA;) ON [PRIMARY]&#xA;&#xA;CREATE TABLE [MRR].[customer](&#xA;&#x9;[customer_id] [int] NOT NULL,&#xA;&#x9;[CUST_NUMBER] [varchar](20) NOT NULL,&#xA;&#x9;[cust_name] [varchar](100) NULL,&#xA;&#x9;[address] [varchar](100) NULL,&#xA;&#x9;[insert_date] [datetime] NULL,&#xA;&#x9;[update_date] [datetime] NULL,&#xA;&#x9;[SysStartTime] [datetime2](7) NULL,&#xA;&#x9;[SysEndTime] [datetime2](7) NULL&#xA;)&#xA;&#xA;CREATE TABLE [MRR].[CUSTOMER_INVOICE](&#xA;&#x9;[INVOICE_NUM] [int] NULL,&#xA;&#x9;[PHONE_NO] [varchar](20) NULL,&#xA;&#x9;[INVOICE_TYPE] [varchar](10) NULL,&#xA;&#x9;[INVOICE_DATE] [datetime] NULL,&#xA;&#x9;[INVOICE_IND] [tinyint] NULL,&#xA;&#x9;[INVOICE_DESC] [varchar](100) NULL,&#xA;&#x9;[INVOICE_CURRNCY] [varchar](10) NULL,&#xA;&#x9;[INVOICE_AMOUNT] [decimal](10, 4) NULL,&#xA;&#x9;[insert_date] [datetime] NULL,&#xA;&#x9;[update_date] [datetime] NULL,&#xA;&#x9;[SysStartTime] [datetime2](7) NULL,&#xA;&#x9;[SysEndTime] [datetime2](7) NULL&#xA;)&#xA;&#xA;CREATE TABLE [MRR].[customer_lines](&#xA;&#x9;[PHONE_NO] [varchar](20) NULL,&#xA;&#x9;[createdate] [datetime] NULL,&#xA;&#x9;[enddate] [datetime] NULL,&#xA;&#x9;[status] [varchar](4) NULL,&#xA;&#x9;[TYPE] [varchar](10) NULL,&#xA;&#x9;[DESC] [varchar](100) NULL,&#xA;&#x9;[insert_date] [datetime] NULL,&#xA;&#x9;[update_date] [datetime] NULL,&#xA;&#x9;[discountpct] [int] NULL,&#xA;&#x9;[numberoffreeminutes] [int] NULL,&#xA;&#x9;[SysStartTime] [datetime2](7) NULL,&#xA;&#x9;[SysEndTime] [datetime2](7) NULL&#xA;)&#xA;&#xA;CREATE TABLE [MRR].[OPFILEOPP](&#xA;&#x9;[OPCCC] [nvarchar](100) NULL,&#xA;&#x9;[OPDDD] [nvarchar](100) NULL,&#xA;&#x9;[prepre] [nvarchar](100) NULL,&#xA;&#x9;[SysStartTime] [datetime2](7) NULL,&#xA;&#x9;[SysEndTime] [datetime2](7) NULL&#xA;)&#xA;&#xA;CREATE TABLE [MRR].[Package_Catalog](&#xA;&#x9;[PACKAGE_NUM] [int] NOT NULL,&#xA;&#x9;[createdate] [datetime] NULL,&#xA;&#x9;[enddate] [datetime] NULL,&#xA;&#x9;[status] [varchar](4) NULL,&#xA;&#x9;[pack_type] [varchar](10) NULL,&#xA;&#x9;[pack_desc] [varchar](100) NULL,&#xA;&#x9;[insert_date] [datetime] NULL,&#xA;&#x9;[update_date] [datetime] NULL&#xA;)&#xA;&#xA;CREATE TABLE [MRR].[USAGE_MAIN](&#xA;&#x9;[CALL_NO] [int] IDENTITY(1,1) NOT NULL,&#xA;&#x9;[ANSWER_TIME] [datetime] NOT NULL,&#xA;&#x9;[SEIZED_TIME] [datetime] NOT NULL,&#xA;&#x9;[DISCONNECT_TIME] [datetime] NOT NULL,&#xA;&#x9;[CALL_DATETIME] [datetime] NULL,&#xA;&#x9;[CALLING_NO] [varchar](18) NULL,&#xA;&#x9;[CALLED_NO] [varchar](18) NULL,&#xA;&#x9;[DES_NO] [varchar](25) NULL,&#xA;&#x9;[DURATION] [int] NULL,&#xA;&#x9;[CUST_ID] [int] NULL,&#xA;&#x9;[CALL_TYPE] [varchar](20) NULL,&#xA;&#x9;[PROD_TYPE] [varchar](20) NULL,&#xA;&#x9;[RATED_AMNT] [int] NULL,&#xA;&#x9;[RATED_CURR_CODE] [varchar](10) NULL,&#xA;&#x9;[CELL] [int] NULL,&#xA;&#x9;[CELL_ORIGIN] [int] NULL,&#xA;&#x9;[HIGH_LOW_RATE] [int] NULL,&#xA;&#x9;[insert_DATE] [datetime] NULL,&#xA;&#x9;[update_date] [datetime] NULL,&#xA;)&#xA;&#xA;CREATE TABLE [MRR].[XXCOUNTRYPRE](&#xA;&#x9;[COUNTRY_CODE] [varchar](100) NOT NULL,&#xA;&#x9;[COUNTRY_PRE] [varchar](3) NULL,&#xA;&#xA;)&#xA;&#xA;----------------------------------END MRR&#xA;&#xA;CREATE TABLE [STG].[call_type](&#xA;&#x9;KeyCallType int identity (1,1),&#xA;&#x9;call_type_code nvarchar(100) not NULL,&#xA;&#x9;call_type_desc nvarchar(100) NULL,&#xA;&#x9;priceperminuter decimal(10, 2) NULL,&#xA;&#x9;call_type nvarchar(50) NULL&#xA;&#x9;Primary Key (KeyCallType)&#xA;)&#xA;&#xA;Create table STG.XXCOUNTRYPRE(&#xA;&#x9;COUNTRY_PRE varchar(3) NULL,&#xA;&#x9;COUNTRY_CODE varchar(100) NOT NULL&#xA;)&#xA;&#xA;Create table STG.countries(&#xA;&#x9;COUNTRY_CODE varchar(100) NULL,&#xA;&#x9;REGION varchar(100) NULL,&#xA;&#x9;AREA varchar(100) NULL&#xA;)&#xA;&#xA;Create table STG.Package_Catalog(&#xA;&#x9;PACKAGE_NUM int NOT NULL,&#xA;&#x9;pack_desc varchar(100) NULL,&#xA;&#x9;createdate datetime NULL,&#xA;&#x9;enddate datetime NULL,&#xA;&#x9;[status] varchar(4) NULL,&#xA;&#x9;[pack_type] [varchar](10) NULL,&#xA;)&#xA;&#xA;Create table STG.OPFILEOPP(&#xA;&#x9;OPCCC nvarchar(100) NULL,&#xA;&#x9;OPDDD nvarchar(100) NULL,&#xA;&#x9;prepre nvarchar(100) NULL&#xA;)&#xA;&#xA;Create table STG.customer_lines(&#xA;&#x9;PHONE_NO varchar(20) NULL,&#xA;&#x9;[DESC] varchar(100) NULL,&#xA;&#x9;[discountpct] float NULL,&#xA;&#x9;[TYPE] [varchar](10) NULL,&#xA;&#x9;[numberoffreeminutes] [int] NULL&#xA;)&#xA;&#xA;Create table STG.customer(&#xA;&#x9;customer_id int NOT NULL,&#xA;&#x9;CUST_NUMBER varchar(20) NOT NULL,&#xA;&#x9;cust_name varchar(100) NULL,&#xA;&#x9;address varchar(100) NULL&#xA;)&#xA;&#xA;CREATE TABLE stg.USAGE_MAIN(&#xA;&#x9;CALL_NO int NOT NULL,&#xA;&#x9;ANSWER_TIME datetime NOT NULL,&#xA;&#x9;SEIZED_TIME datetime NOT NULL,&#xA;&#x9;CALL_DATETIME datetime NULL,&#xA;&#x9;CALLING_NO nvarchar(18) NULL,&#xA;&#x9;DES_NO nvarchar(25) NULL,&#xA;&#x9;DURATION int NULL,&#xA;&#x9;CUST_ID int NULL,&#xA;&#x9;CALL_TYPE nvarchar (20) NULL,&#xA;&#x9;PROD_TYPE nvarchar(20) NULL,&#xA;&#x9;RATED_AMNT int NULL,&#xA;&#x9;CELL_ORIGIN int NULL,&#xA;&#x9;Primary Key (CALL_NO)&#xA;)&#xA;&#xA;----------------------------------END STG&#xA;&#xA;Create table Dim.DimCallTypes&#xA;(&#xA;&#x9;SKeyCallType int identity (100,1),&#xA;&#x9;KeyCallType int,&#xA;&#x9;DescCallTypeCode nvarchar(100),&#xA;&#x9;DescCallType nvarchar(100),&#xA;&#x9;DescFullCallType nvarchar(200),&#xA;&#x9;DescCallTypePriceCategory nvarchar(100),&#xA;&#x9;DescCallTypeCategory nvarchar(100),&#xA;&#x9;IsCurrent nvarchar(100),&#xA;&#x9;StartTime Datetime,&#xA;&#x9;Endtime Datetime&#xA;&#x9;Primary Key (SKeyCallType)&#xA;)&#xA;&#xA;&#x9;Create table Dim.DimCountries&#xA;(&#xA;&#x9;[SKeyCountry] [int] IDENTITY(100,1) NOT NULL,&#xA;&#x9;[KeyCountry] [int] NULL,&#xA;&#x9;[DescCountry] [nvarchar](100) NULL,&#xA;&#x9;[DescRegion] [nvarchar](100) NULL,&#xA;&#x9;[DescArea] [nvarchar](100) NULL&#xA;&#x9;Primary Key (SKeyCountry)&#xA;)&#xA;&#xA;&#x9;Create table Dim.DimPackageCatalog&#xA;(&#xA;&#x9;SKeyPackage int identity (100,1),&#xA;&#x9;KeyPackage int,&#xA;&#x9;DescPackage nvarchar(120),&#xA;&#x9;DatePackageCreation date,&#xA;&#x9;DatePackageEnd date,&#xA;&#x9;DescPackageStatus nvarchar(100),&#xA;&#x9;CodePackageActivitiesDays int,&#xA;&#x9;IsCurrent nvarchar(100),&#xA;&#x9;StartTime Datetime,&#xA;&#x9;Endtime Datetime&#xA;&#x9;Primary Key (SKeyPackage)&#xA;)&#xA;&#xA;&#x9;Create table Dim.DimOperators&#xA;(&#xA;&#x9;SKeyOperator int identity (100,1),&#xA;&#x9;KeyOperator int,&#xA;&#x9;DescOperator nvarchar(50),&#xA;&#x9;DescKeyPrefix nvarchar(100),&#xA;&#x9;IsCurrent nvarchar(100),&#xA;&#x9;StartTime Datetime,&#xA;&#x9;Endtime Datetime&#xA;&#x9;Primary Key (SKeyOperator)&#xA;)&#xA;&#xA;&#x9;Create table Dim.DimCustomers&#xA;(&#xA;&#x9;SKeyCustomer int identity (100,1),&#xA;&#x9;KeyCustomer&#x9;int,&#xA;&#x9;DescCustomerLineOperator nvarchar(50),&#xA;&#x9;DescCustomerLineCountry nvarchar(100),&#xA;&#x9;DescCustomerName nvarchar(100),&#xA;&#x9;DescCustomerAddress nvarchar(100),&#xA;&#x9;DescCusomterPackage nvarchar(100),&#xA;&#x9;IsCurrent nvarchar(100),&#xA;&#x9;StartTime Datetime,&#xA;&#x9;Endtime Datetime&#xA;&#x9;Primary Key (SKeyCustomer)&#xA;)&#xA;&#xA;&#x9;Create table Dim.DimCallOriginType&#xA;(&#xA;&#x9;SKeyCallOriginType int identity (100,1),&#xA;&#x9;KeyCallOriginType int,&#xA;&#x9;DescCallOriginType nvarchar(100),&#xA;&#x9;IsCurrent nvarchar(100),&#xA;&#x9;StartTime Datetime,&#xA;&#x9;Endtime Datetime&#xA;&#x9;Primary Key (SKeyCallOriginType)&#xA;)&#xA;&#xA;&#x9;Create table Fact.FactUsage&#xA;(&#xA;&#x9;CallId int,&#xA;&#x9;SKeyCustomer int,&#xA;&#x9;SKeyCallType int,&#xA;&#x9;SKeyOriginCountry int,&#xA;&#x9;SKeyDestinationCountry int,&#xA;&#x9;SKeyOriginOperator int,&#xA;&#x9;SKeyDestinationOperator int,&#xA;&#x9;SKeyPackage int,&#xA;&#x9;SKeyCallOriginType int,&#xA;&#x9;KeyCallDate int,&#xA;&#x9;KeyCallTime int,&#xA;&#x9;Duration int,&#xA;&#x9;BillableDuration int,&#xA;&#x9;Amount float,&#xA;&#x9;BillableAmount float&#xA;&#x9;Primary Key (CallId)&#xA;)&#xA;&#xA;create table dim.DimDate(&#xA;&#x9; KeyDate int not NULL identity(1,1)&#xA;&#x9;,FullDate date&#xA;&#x9;,KeyYear int&#xA;&#x9;,CodeYear int&#xA;&#x9;,DescYear nvarchar(50)&#xA;&#x9;,KeyMonth int&#xA;&#x9;,CodeMonth int&#xA;&#x9;,DescMonth nvarchar(50)&#xA;&#x9;,CodeDayInWeek int&#xA;&#x9;,DescDayInWeek nvarchar(50)&#xA;&#x9;Primary Key (KeyDate)&#xA;)&#xA;&#xA;Create table Dim.DimTime(&#xA;KeyTime&#x9;int,&#xA;FullTime time(0),&#xA;CodeHour int,&#xA;DescHour nvarchar(50),&#xA;KeyMinute int,&#xA;CodeMinute int,&#xA;DescMinute nvarchar(50)&#xA;Primary Key (KeyTime)&#xA;)&#xA;&#xA;alter table fact.factusage &#xA;ADD  CONSTRAINT FK_SKeyCallOriginType&#xA;&#x9; FOREIGN KEY ([SKeyCallOriginType]) REFERENCES [DIM].[DimCallOriginType]([SKeyCallOriginType]),&#xA;&#x9; CONSTRAINT FK_SKeyCallType&#xA;&#x9; FOREIGN KEY ([SKeyCallType]) REFERENCES [DIM].[DimCallTypes]([SKeyCallType]),&#xA;&#x9; CONSTRAINT FK_SKeyOriginCountry&#xA;&#x9; FOREIGN KEY (SKeyOriginCountry) REFERENCES [DIM].[DimCountries]([SKeyCountry]),&#xA;&#x9; CONSTRAINT FK_SKeyDestinationCountry&#xA;&#x9; FOREIGN KEY ([SKeyDestinationCountry]) REFERENCES [DIM].[DimCountries]([SKeyCountry]),&#xA;&#x9; CONSTRAINT FK_SKeyCustomer&#xA;&#x9; FOREIGN KEY ([SKeyCustomer]) REFERENCES [DIM].[DimCustomers]([SKeyCustomer]),&#xA;&#x9; CONSTRAINT FK_SKeyOriginOperator&#xA;&#x9; FOREIGN KEY ([SKeyOriginOperator]) REFERENCES [DIM].[DimOperators]([SKeyOperator]),&#xA;&#x9; CONSTRAINT FK_SKeyDestinationOperator&#xA;&#x9; FOREIGN KEY ([SKeyDestinationOperator]) REFERENCES [DIM].[DimOperators]([SKeyOperator]),&#xA;&#x9; CONSTRAINT FK_SKeyPackage&#xA;&#x9; FOREIGN KEY ([SKeyPackage]) REFERENCES [DIM].[DimPackageCatalog]([SKeyPackage]),&#xA;&#x9; CONSTRAINT FK_KeyCallDate&#xA;&#x9; FOREIGN KEY ([KeyCallDate]) REFERENCES [DIM].[DimDate]([KeyDate]),&#xA;&#x9; CONSTRAINT FK_KeyCallTime&#xA;&#x9; FOREIGN KEY ([KeyCallTime]) REFERENCES [DIM].[DimTime]([KeyTime])&#xA;&#xA;&#xA;----------------------------------END DIM&#xA;&#xA;create table Integration.lineage(&#xA;[lineage key] int not null identity,&#xA;[Data Load Started] Datetime2(7) not null,&#xA;[Table Name] [sysname] not null,&#xA;[Computer Name] [sysname] not null,&#xA;[User Name] [sysname] not null,&#xA;[Package Name] [sysname] not null&#xA; CONSTRAINT [PK_Integration_Lineage] PRIMARY KEY CLUSTERED &#xA;(&#xA;&#x9;[Lineage Key] ASC&#xA;))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Create_SP_insert_usage_main"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{26B7C951-7BD0-4F08-A2C8-4FDD343F169F}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create_SP_insert_usage_main"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; Â© 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{56E81B3E-6240-41C2-9357-BE70DD8EBE43}"
          SQLTask:SqlStatementSource="use TheVoice&#xA;DROP PROCEDURE IF EXISTS   [dbo].[insert_usage_main] &#xA;go&#xA;Create PROCEDURE [dbo].[insert_usage_main]   @a datetime, @b datetime&#xA;&#xA;AS &#xA;print 'start'&#xA;DECLARE @date datetime&#x9;&#xA;set @date = @a&#xA;&#xA;declare @number_call_per_day int&#xA;&#xA;&#x9;while @date &lt; @b&#xA;&#x9;begin&#xA;&#x9;set @number_call_per_day = FLOOR(RAND()*(10-0+1))+0  &#xA;&#xA;&#x9;declare @ENDDAY datetime = DATEADD(DAY, 1, @DATE)&#xA;&#x9;declare @SEIZED_TIME  datetime = @date&#xA;&#x9;print @SEIZED_TIME&#xA;&#x9;while @number_call_per_day &gt; 0 &#xA;&#x9;&#x9;begin&#xA;&#x9;&#x9;DECLARE @Seconds INT = DATEDIFF(SECOND , @SEIZED_TIME, @ENDDAY)&#xA;&#x9;&#x9;DECLARE @RANDSECOND INT=  RAND()*(@Seconds/20 -1) &#xA;&#x9;&#x9;declare @randAnswer int = rand ()* (35 -1)&#xA;&#x9;&#x9;SET @SEIZED_TIME =  DATEADD (SECOND, @RANDSECOND,  @SEIZED_TIME)&#x9;&#x9;&#xA;&#x9;&#x9;declare @answer_time datetime = dateadd (second ,@randAnswer,@SEIZED_TIME)&#xA;&#x9;&#x9;declare @custid int = rand ()*((select count (customer_id ) from [dbo].[customer])-1 ) +1&#xA;&#x9;&#x9;declare @randDisconnect int = rand()* (1000)&#xA;&#x9;&#x9;declare @DISCONNECT_TIME datetime = dateadd (second ,@randDisconnect,@answer_time)&#xA;&#x9;&#x9;declare @DURATION int =( DATEDIFF(MINUTE, @answer_time , @DISCONNECT_TIME))&#xA;&#x9;&#x9;declare @CALLING_NO varchar(20) = (select CUST_NUMBER from [dbo].[customer] where customer_id = @custid)&#xA;&#x9;&#x9; declare  @priceperminuter decimal (10,2),&#xA;&#x9;&#x9; @call_type varchar (10),&#xA;&#x9;&#x9; @call_type_desc varchar (20)&#xA; select  top 1 @call_type = call_type_code ,@call_type_desc = call_type_desc,&#xA; @priceperminuter = priceperminuter&#xA; FROM [TheVoice].[dbo].[call_type]&#xA; order by NEWID ()&#xA; declare @RATED_AMNT int = @priceperminuter * @DURATION&#xA; print @RATED_AMNT&#xA;  declare @called_NO varchar (18) = (select top 1 CALLED_NO from [dbo].[USAGE_MAIN]&#xA;  where CUST_ID  != @custid order by NEWID ())&#xA; declare @DES_NO varchar (25) = @called_NO &#xA;  declare @cell int  if  @called_NO like '+121%' set  @cell =0 else set @cell = 1&#xA;   declare @cell_origin int  if  @CALLING_NO like '+121%' set  @cell_origin =0 else set @cell_origin = 1&#xA;&#x9;&#x9;INSERT INTO dbo.USAGE_MAIN (CALL_DATETIME,SEIZED_TIME,ANSWER_TIME,&#xA;&#x9;&#x9;DISCONNECT_TIME,CUST_ID,CALLING_NO,DURATION,call_type,PROD_TYPE,RATED_AMNT,&#xA;&#x9;&#x9;CALLED_NO,DES_NO,cell,CELL_ORIGIN)&#xA;&#x9;&#x9;VALUES (@date,@SEIZED_TIME,@answer_time,@answer_time,@custid,&#xA;&#x9;&#x9;@CALLING_NO,@DURATION,@call_type,@call_type_desc,@RATED_AMNT,@called_NO,@DES_NO,@cell,@cell_origin)&#xA;&#x9;&#x9;set @number_call_per_day = @number_call_per_day - 1&#xA;&#x9;&#xA;&#x9;&#x9;end &#xA;&#x9;&#x9;set @date =  DATEADD(DAY, 1,@date) &#xA;&#x9;end&#xA;&#x9;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\exec_insert_usage_main"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{BE74DA70-54C5-438A-B0F8-BED3B151DC78}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="exec_insert_usage_main"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; Â© 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{56E81B3E-6240-41C2-9357-BE70DD8EBE43}"
          SQLTask:SqlStatementSource="use TheVoice&#xA;exec[insert_usage_main] '2013-01-01 00:00:00.000' , '2013-10-06 00:00:00.000'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\exec_insert_usage_main 1"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5c095efa-9c00-4bd2-90c5-5be13c99c6db}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="exec_insert_usage_main 1"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; Â© 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{56E81B3E-6240-41C2-9357-BE70DD8EBE43}"
          SQLTask:SqlStatementSource="use TheVoice&#xA;exec [dbo].[insert_usage_main] '2013-10-09 00:00:00.000' , '2013-12-31 00:00:00.000'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\exec_insert_usage_main 2"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{95af3de9-ff86-4020-8338-d36e1aaba882}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="exec_insert_usage_main 2"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; Â© 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{56E81B3E-6240-41C2-9357-BE70DD8EBE43}"
          SQLTask:SqlStatementSource="use TheVoice&#xA;exec [dbo].[insert_usage_main] '2014-01-01 00:00:00.000' , '2014-12-31 00:00:00.000'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\exec_insert_usage_main 3"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{8f9bec83-4e36-48dd-a04f-c8b0509cdc8c}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="exec_insert_usage_main 3"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; Â© 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{56E81B3E-6240-41C2-9357-BE70DD8EBE43}"
          SQLTask:SqlStatementSource="use TheVoice&#xA;exec [dbo].[insert_usage_main] '2015-01-01 00:00:00.000' , '2015-12-31 00:00:00.000'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{6F929CA3-E2D2-420D-96D8-310EFB63DCE1}"
      DTS:From="Package\Create_DWH_DB"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Create_SP_insert_usage_main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{99FE91B4-7B61-43E3-B4FD-5DEC578B972A}"
      DTS:From="Package\Create_SP_insert_usage_main"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\exec_insert_usage_main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{E057EE75-35AC-4854-8498-4321BB17FD60}"
      DTS:From="Package\exec_insert_usage_main"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\exec_insert_usage_main 1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{8DB93C28-A31C-4B08-B75B-0132F6E3CD73}"
      DTS:From="Package\exec_insert_usage_main 1"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\exec_insert_usage_main 2" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{79C5614C-5296-41F6-89DF-E13034869479}"
      DTS:From="Package\exec_insert_usage_main 2"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\exec_insert_usage_main 3" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="159,42"
          Id="Package\Create_DWH_DB"
          TopLeft="293.5,72.5" />
        <NodeLayout
          Size="222,42"
          Id="Package\Create_SP_insert_usage_main"
          TopLeft="264.5,171.5" />
        <NodeLayout
          Size="195,42"
          Id="Package\exec_insert_usage_main"
          TopLeft="275.5,267.5" />
        <NodeLayout
          Size="204,42"
          Id="Package\exec_insert_usage_main 1"
          TopLeft="275,355" />
        <NodeLayout
          Size="204,42"
          Id="Package\exec_insert_usage_main 2"
          TopLeft="551,355" />
        <NodeLayout
          Size="204,42"
          Id="Package\exec_insert_usage_main 3"
          TopLeft="552.5,267" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="374.25,114.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,57"
              Start="0,0"
              End="0,49.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="374.25,213.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,54"
              Start="0,0"
              End="0,46.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="375,309.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45.5"
              Start="0,0"
              End="0,38">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="479,376">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="72,0"
              Start="0,0"
              End="64.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="64.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="653.75,355">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-46"
              Start="0,0"
              End="0,-38.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-38.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Run One Time"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="118,60"
          Id="4c40b247-025b-4614-a76a-7323b35a7258"
          TopLeft="467,53" />
        <AnnotationLayout
          Text="run multiple times"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="125,40"
          Id="a933061a-2008-4463-bd62-d1ba23cf91a4"
          TopLeft="132.5,269" />
        <AnnotationLayout
          Text="run multiple times"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="125,40"
          Id="40e43360-c126-4759-92f7-8832b5b076d4"
          TopLeft="132.5,357" />
        <AnnotationLayout
          Text="run multiple times"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="125,40"
          Id="657f0145-83b2-4b0e-91e5-89d2cddd0a8c"
          TopLeft="770.5,356" />
        <AnnotationLayout
          Text="run multiple times"
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="125,40"
          Id="f763b9bb-7119-4ff6-ad70-938a06fd2cbc"
          TopLeft="770.5,265" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>